@0
LOAD:MOV UP,ACC
MOV ACC,LEFT
JNZ LOAD
DONE:MOV 1,DOWN
MAIN:JRO DOWN
MOV RIGHT,ACC
JEZ V
MOV ACC,RIGHT
<-:MOV RIGHT,ACC
MOV ACC,LEFT
JNZ <-
JMP DONE
MOV DOWN,RIGHT
JMP MAIN
V:MOV 13,DOWN

@1
^^:MOV 0,UP
JRO RIGHT
MOV 1,DOWN
MOV UP,NIL
MOV UP,DOWN
^:MOV UP,ACC
JEZ DONE
MOV 1,RIGHT
MOV ACC,RIGHT
MOV 1,DOWN
MOV ACC,DOWN
JMP ^
DONE:MOV 7,DOWN
MOV -2,RIGHT
JMP ^^

@2
^:JRO ANY
MOV 3,DOWN
MOV 1,DOWN
MOV 8,UP
MOV 0,UP
MOV 1,LEFT
JMP ->
MOV 1,UP
JMP ^
->:JRO LEFT
MOV 8,UP
MOV LEFT,UP
JMP ->
NXT:MOV -99,DOWN
MOV 5,DOWN

@3


@4
MOV UP,NIL
MOV UP,ACC
MAIN:SAV
JRO UP
SUB UP
JEZ MATCH
SWP
JMP MAIN
MATCH:MOV 1,RIGHT
JRO -3
MOV -4,RIGHT
MOV ACC,RIGHT

@5
^:SWP
JMP MAIN
MOV 1,RIGHT
MOV ACC,RIGHT
MOV ACC,RIGHT
MOV LEFT,ACC
MAIN:JRO ANY
ADD 1
JMP MAIN
MOV 0,ACC
JMP MAIN
V:MOV ACC,DOWN
MOV -1,RIGHT

@6
MOV 0,ACC
MAIN:JRO LEFT
SUB LEFT
JEZ ZERO
JLZ SWAP
ADD LEFT
JMP MAIN
SWAP:MOV LEFT,ACC
MOV -99,LEFT
JMP MAIN
ZERO:ADD LEFT
MOV 3,LEFT
MOV -99,LEFT
JMP MAIN